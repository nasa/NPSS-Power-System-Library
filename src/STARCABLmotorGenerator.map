//  ----------------------------------------------------------------------
//  |    Declaration of a new subelement instance MotorGeneratorMap
//  |    that is of the type: MotorGeneratorMap
//  ----------------------------------------------------------------------

//------------------------------------------------------------
//  ******  ADD SOLVER INDEPENDENTS & DEPENDENTS  ******
//------------------------------------------------------------

Independent ind_trqTemp {
    varName = "trqTemp";
    description = "Varies temporary torque to match calculated torque for map";
    // autoSetup = TRUE;
}

Dependent dep_trq_map {
    eq_lhs = "trqTemp";
    eq_rhs = "trq";
    // autoSetup = TRUE;
}

//---------------------------------------------
// ******* VARIABLE CHANGED METHODOLOGY *******
//---------------------------------------------

void variableChanged(string name, any oldVal) {
    if (name == "switchThermPort") { 
        if (switchThermPort == "TRUE") {
            create("", "ThermalInputPort", "Q_I" );
        }
    }

    if (name =="switchDes") {
        if (switchDes == DESIGN) {
            ind_trqTemp.autoSetup = FALSE;
            dep_trq_map.autoSetup = FALSE;
        } else if (switchDes == OFFDESIGN) {
            effDes.IOstatus = "output";
            ind_trqTemp.autoSetup = TRUE;
            dep_trq_map.autoSetup = TRUE;
        }
    }
}

Subelement MotorGeneratorMap S_map {

    // default design point location
    NmapDes = .5;
    trqMapDes = .488;

    // resulting performance
    //effMap = 

    Table TB_eff(real trqMap, real Nmap){

        trqMap = .04{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .873,    .863,   .854,  .846,   .839,   .833, .826,   .820,   .814,  .808,   .803,  .797}
        }
        trqMap = .104{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .928,    .932,   .930,  .928,   .926,   .923, .920,   .918,   .915,  .912,   .909,  .907}
        }
        trqMap = .168{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .932,    .944,   .947,  .947,   .947,   .946, .945,   .943,   .942,  .940,   .938,  .937}
        }
        trqMap = .232{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .927,    .946,   .952,  .954,   .955,   .955, .954,   .954,   .953,  .952,   .951,  .950}
        }
        trqMap = .296{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .918,    .944,   .952,  .956,   .958,   .958, .959,   .959,   .958,  .958,   .957,  .956}
        }
        trqMap = .36{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .908,    .940,   .951,  .956,   .958,   .960, .961,   .961,   .961,  .961,   .960,  .960}
        }
        trqMap = .424{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .898,    .935,   .948,  .954,   .958,   .960, .961,   .962,   .962,  .962,   .962,  .962}
        }
        trqMap = .488{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .887,    .930,   .945,  .952,   .956,   .959, .960,   .962,   .962,  .963,   .963,  .963}
        }
        trqMap = .552{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .876,    .924,   .941,  .949,   .954,   .957, .960,   .961,   .962,  .962,   .963,  .963}
        }
        trqMap = .616{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .865,    .918,   .937,  .946,   .952,   .956, .958,   .960,   .961,  .962,   .962,  .962}
        }
        trqMap = .68{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .854,    .912,   .932,  .943,   .949,   .953, .956,   .958,   .960,  .961,   .961,  .962}
        }
        trqMap = .744{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .843,    .905,   .928,  .939,   .947,   .951, .954,   .957,   .958,  .959,   .960,  .961}
        }
        trqMap = .808{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .832,    .899,   .923,  .936,   .944,   .949, .952,   .955,   .957,  .958,   .959,  .959}
        }
        trqMap = .872{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .821,    .892,   .918,  .932,   .940,   .946, .950,   .953,   .955,  .956,   .957,  .958}
        }
        trqMap = .936{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .808,    .884,   .912,  .927,   .936,   .942, .947,   .950,   .952,  .954,   .955,  .956}
        }
        trqMap = 1.{
            Nmap =   {.083333, .16667, .25,   .33333, .41667, .5,   .58333, .66667, .75,   .83333, .91667, 1.  }
            effMap = { .796,    .877,   .907,  .923,   .933,   .939, .944,   .948,   .950,  .952,   .953,  .954}
        }

        Nmap.interp = "linear";    //find more accurate case
        Nmap.extrap = "none";

        trqMap.interp = "linear";    //find more accurate case
        trqMap.extrap = "none";

        printExtrap = 1;
    } // end TB_eff  
} // end S_map